<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>News Article - Oasis Bible Institute</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="../assets/css/style.css">
</head>
<body class="bg-gray-50">
    <nav class="bg-teal-900 shadow-lg fixed w-full top-0 z-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-20">
                <div class="flex items-center">
                    <a href="index.html" class="flex items-center">
                        <img src="../assets/images/obi-logo.jpg" alt="OBI Logo" class="h-12 w-auto" onerror="this.src='../assets/images/obi-logo.jpg';">
                        <span class="ml-3 text-xl font-bold text-white">Oasis Bible Institute</span>
                    </a>
                </div>

                <!-- Desktop Menu -->
                <div class="hidden lg:flex items-center space-x-6">
                    <a href="index.html" class="text-teal-100 hover:text-white transition">Home</a>

                    <div class="relative group">
                        <button class="text-teal-100 hover:text-white transition flex items-center py-2">
                            About <i class="fas fa-chevron-down ml-1 text-xs"></i>
                        </button>
                        <div class="absolute hidden group-hover:block bg-teal-800 shadow-lg rounded-md pt-2 w-56 z-50 top-full">
                            <a href="../about.html" class="block px-4 py-2 hover:bg-teal-700 text-white">About Us</a>
                            <a href="../leadership.html" class="block px-4 py-2 hover:bg-teal-700 text-white">Leadership</a>
                            <a href="../ministries.html" class="block px-4 py-2 hover:bg-teal-700 text-white">Ministries</a>
                        </div>
                    </div>

                    <div class="relative group">
                        <button class="text-teal-100 hover:text-white transition flex items-center py-2">
                            Programs <i class="fas fa-chevron-down ml-1 text-xs"></i>
                        </button>
                        <div class="absolute hidden group-hover:block bg-teal-800 shadow-lg rounded-md pt-2 w-56 z-50 top-full">
                            <a href="index.html" class="block px-4 py-2 hover:bg-teal-700 text-white">Bible Institute</a>
                            <a href="admissions.html" class="block px-4 py-2 hover:bg-teal-700 text-white">OBI Admissions</a>
                            <a href="../admissions.html" class="block px-4 py-2 hover:bg-teal-700 text-white">Ministry Training</a>
                        </div>
                    </div>

                    <div class="relative group">
                        <button class="text-teal-100 hover:text-white transition flex items-center py-2">
                            Get Involved <i class="fas fa-chevron-down ml-1 text-xs"></i>
                        </button>
                        <div class="absolute hidden group-hover:block bg-teal-800 shadow-lg rounded-md pt-2 w-56 z-50 top-full">
                            <a href="../credential-application.html" class="block px-4 py-2 hover:bg-teal-700 text-white">Credential Application</a>
                            <a href="../sponsor-student.html" class="block px-4 py-2 hover:bg-teal-700 text-white">Sponsor a Student</a>
                            <a href="../contact.html" class="block px-4 py-2 hover:bg-teal-700 text-white">Contact Us</a>
                        </div>
                    </div>

                    <a href="../gallery.html" class="text-teal-100 hover:text-white transition">Gallery</a>

                    <div id="user-menu" class="hidden">
                        <div class="relative group">
                            <button class="flex items-center text-teal-100 hover:text-white transition">
                                <i class="fas fa-user-circle text-2xl"></i>
                                <i class="fas fa-chevron-down ml-1 text-xs"></i>
                            </button>
                            <div class="absolute right-0 hidden group-hover:block bg-teal-800 shadow-lg rounded-md pt-2 w-48 z-50 top-full">
                                <a href="../dashboard/index.html" class="block px-4 py-2 hover:bg-teal-700 text-white">Dashboard</a>
                                <button onclick="window.handleSignOut()" class="w-full text-left block px-4 py-2 hover:bg-teal-700 text-red-300">Sign Out</button>
                            </div>
                        </div>
                    </div>

                    <button id="sign-in-btn" class="bg-teal-600 text-white px-6 py-2 rounded-md hover:bg-teal-700 transition">
                        Sign In
                    </button>
                </div>

                <!-- Mobile menu button -->
                <div class="lg:hidden flex items-center">
                    <button id="mobile-menu-btn" class="text-white hover:text-teal-100">
                        <i class="fas fa-bars text-2xl"></i>
                    </button>
                </div>
            </div>
        </div>

        <!-- Mobile Menu -->
        <div id="mobile-menu" class="hidden lg:hidden bg-teal-800 border-t border-teal-700">
            <div class="px-4 py-3 space-y-3">
                <a href="index.html" class="block text-teal-100">Home</a>
                <a href="../about.html" class="block text-teal-100">About Us</a>
                <a href="../leadership.html" class="block text-teal-100 pl-4">Leadership</a>
                <a href="../ministries.html" class="block text-teal-100 pl-4">Ministries</a>
                <a href="index.html" class="block text-teal-100">Bible Institute</a>
                <a href="admissions.html" class="block text-teal-100 pl-4">OBI Admissions</a>
                <a href="../admissions.html" class="block text-teal-100 pl-4">Ministry Training</a>
                <a href="../credential-application.html" class="block text-teal-100">Credential Application</a>
                <a href="../sponsor-student.html" class="block text-teal-100 pl-4">Sponsor Student</a>
                <a href="../contact.html" class="block text-teal-100 pl-4">Contact</a>
                <a href="../gallery.html" class="block text-teal-100">Gallery</a>
                <button id="mobile-sign-in-btn" class="w-full bg-teal-600 text-white px-4 py-2 rounded-md text-center mt-2">Sign In</button>
                <div id="mobile-user-menu" class="hidden">
                    <a href="../dashboard/index.html" class="block text-teal-100 pl-4">Dashboard</a>
                    <button onclick="window.handleSignOut()" class="w-full text-left text-red-300 px-4 py-2">Sign Out</button>
                </div>
            </div>
        </div>
    </nav>

    <section class="mt-20 bg-teal-900 text-white py-12">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <nav class="text-teal-200 mb-4">
                <a href="index.html" class="hover:text-white">Home</a>
                <span class="mx-2">/</span>
                <a href="news.html" class="hover:text-white">News</a>
                <span class="mx-2">/</span>
                <span id="news-breadcrumb">Article</span>
            </nav>
            <h1 id="news-title" class="text-4xl font-bold">News Article</h1>
        </div>
    </section>

    <section class="py-20">
        <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8">
            <article class="bg-white rounded-lg shadow-lg overflow-hidden">
                <img id="news-image" src="../assets/images/news1.jpg" alt="News" class="w-full h-96 object-cover">
                <div class="p-8">
                    <div class="flex items-center justify-between mb-6">
                        <div class="flex items-center text-gray-600">
                            <i class="fas fa-calendar mr-2"></i>
                            <span id="news-date">October 1, 2024</span>
                        </div>
                        <div class="flex items-center text-gray-600">
                            <i class="fas fa-user mr-2"></i>
                            <span id="news-author">Admin</span>
                        </div>
                    </div>
                    <div id="news-content" class="prose max-w-none text-gray-600 leading-relaxed">
                        <p>Loading article content...</p>
                    </div>
                    <div class="mt-8 pt-8 border-t">
                        <h3 class="font-bold text-gray-900 mb-4">Share this article</h3>
                        <div class="flex space-x-4">
                            <a href="#" class="text-blue-600 hover:text-blue-700"><i class="fab fa-facebook text-2xl"></i></a>
                            <a href="#" class="text-blue-400 hover:text-blue-500"><i class="fab fa-twitter text-2xl"></i></a>
                            <a href="#" class="text-blue-700 hover:text-blue-800"><i class="fab fa-linkedin text-2xl"></i></a>
                        </div>
                    </div>
                </div>
            </article>

            <div class="mt-12">
                <h3 class="text-2xl font-bold text-gray-900 mb-6">Related News</h3>
                <div class="grid md:grid-cols-2 gap-6">
                    <a href="news-item.html?id=2" class="bg-white rounded-lg shadow-lg overflow-hidden block hover:shadow-xl transition">
                        <img src="../assets/images/news2.jpg" alt="Related" class="w-full h-40 object-cover">
                        <div class="p-4">
                            <h4 class="font-bold text-gray-900 mb-2">Graduation Ceremony Success</h4>
                            <p class="text-sm text-gray-600">September 15, 2024</p>
                        </div>
                    </a>
                    <a href="news-item.html?id=3" class="bg-white rounded-lg shadow-lg overflow-hidden block hover:shadow-xl transition">
                        <img src="../assets/images/news3.jpg" alt="Related" class="w-full h-40 object-cover">
                        <div class="p-4">
                            <h4 class="font-bold text-gray-900 mb-2">New Library Resources</h4>
                            <p class="text-sm text-gray-600">September 1, 2024</p>
                        </div>
                    </a>
                </div>
            </div>

            <div class="mt-8">
                <a href="news.html" class="text-teal-600 font-semibold hover:text-teal-700 inline-flex items-center">
                    <i class="fas fa-arrow-left mr-2"></i> Back to News
                </a>
            </div>
        </div>
    </section>

    <footer class="bg-gray-900 text-white py-12">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
            <p>&copy; 2024 Oasis Bible Institute. All rights reserved.</p>
        </div>
    </footer>

    <script type="module" src="../assets/js/main.js"></script>
    <script type="module">
        import { db } from '../assets/js/firebase-config.js';
        import { doc, getDoc } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js';

        async function loadNewsArticle() {
            const urlParams = new URLSearchParams(window.location.search);
            const newsId = urlParams.get('id');

            if (!newsId) {
                window.location.href = 'news.html';
                return;
            }

            try {
                const docRef = doc(db, 'news', newsId);
                const docSnap = await getDoc(docRef);

                if (docSnap.exists()) {
                    const article = docSnap.data();
                    const publishedDate = article.publishedAt?.toDate?.() || new Date();

                    // Convert Google Drive URL to direct image URL
                    const imageUrl = window.convertGoogleDriveUrl ? window.convertGoogleDriveUrl(article.image) : article.image;

                    document.getElementById('news-title').textContent = article.title;
                    document.getElementById('news-breadcrumb').textContent = article.title;
                    document.getElementById('news-image').src = imageUrl || '../assets/images/logo.jpg';
                    document.getElementById('news-image').onerror = function() { this.src = '../assets/images/logo.jpg'; };
                    document.getElementById('news-date').textContent = publishedDate.toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' });
                    document.getElementById('news-author').textContent = article.author || 'Admin';

                    // Format content with proper paragraphs
                    const content = article.content || article.excerpt || '<p>No content available.</p>';
                    const formattedContent = content.split('\n\n').map(para => `<p class="mb-4">${para}</p>`).join('');
                    document.getElementById('news-content').innerHTML = formattedContent;

                    // Update page title
                    document.title = `${article.title} - Oasis Bible Institute`;
                } else {
                    console.error('News article not found');
                    document.getElementById('news-content').innerHTML = '<p>News article not found.</p>';
                }
            } catch (error) {
                console.error('Error loading news article:', error);
                document.getElementById('news-content').innerHTML = '<p>Error loading news article. Please try again later.</p>';
            }
        }

        window.addEventListener('load', loadNewsArticle);
    </script>
</body>
</html>